!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("vue"),require("@blazes/utils"),require("@blazes/theme"),require("ant-design-vue/lib/form"),require("ant-design-vue/lib/input"),require("ant-design-vue/lib/row"),require("ant-design-vue/lib/col"),require("ant-design-vue/lib/button"));else if("function"==typeof define&&define.amd)define([,"@blazes/utils","@blazes/theme","ant-design-vue/lib/form","ant-design-vue/lib/input","ant-design-vue/lib/row","ant-design-vue/lib/col","ant-design-vue/lib/button"],t);else{var n="object"==typeof exports?t(require("vue"),require("@blazes/utils"),require("@blazes/theme"),require("ant-design-vue/lib/form"),require("ant-design-vue/lib/input"),require("ant-design-vue/lib/row"),require("ant-design-vue/lib/col"),require("ant-design-vue/lib/button")):t(e.Vue,e["@blazes/utils"],e["@blazes/theme"],e["ant-design-vue/lib/form"],e["ant-design-vue/lib/input"],e["ant-design-vue/lib/row"],e["ant-design-vue/lib/col"],e["ant-design-vue/lib/button"]);for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(window,(function(e,t,n,o,r,a,l,u){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=27)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},,,,,function(e,t){e.exports=o},function(e,t){e.exports=r},,function(e,t){e.exports=a},function(e,t){e.exports=l},function(e,t){e.exports=u},,function(e,t,n){},,,,,,,,function(e,t,n){"use strict";n(14)},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"isBlank",(function(){return S})),n.d(t,"getEnum",(function(){return q})),n.d(t,"getCopyEnum",(function(){return $})),n.d(t,"getData",(function(){return _})),n.d(t,"transMapToEnum",(function(){return N})),n.d(t,"formRefSymbol",(function(){return u})),n.d(t,"formSymbol",(function(){return l}));var o=n(0);const r=Object(o.withScopeId)("data-v-a5e051da"),a=r((e,t,n,a,l,u)=>{var i,c;const s=Object(o.resolveComponent)("a-form-item"),d=Object(o.resolveComponent)("a-col"),b=Object(o.resolveComponent)("a-row"),p=Object(o.resolveComponent)("a-form"),f=Object(o.resolveComponent)("a-button"),m=Object(o.resolveDirective)("btn-loading");return Object(o.openBlock)(),Object(o.createBlock)("div",null,[Object(o.createVNode)(p,{model:e.form,ref:"formRef",layout:(null===(i=e.schema)||void 0===i||null===(c=i.ui)||void 0===c?void 0:c.layout)||"horizontal"},{default:r(()=>[Object(o.createVNode)(b,null,{default:r(()=>[(Object(o.openBlock)(!0),Object(o.createBlock)(o.Fragment,null,Object(o.renderList)(e.items,t=>(Object(o.openBlock)(),Object(o.createBlock)(d,{key:t.ui.prop,span:t.ui.gutter.span},{default:r(()=>[t.show?(Object(o.openBlock)(),Object(o.createBlock)(s,{key:0,label:e.$slots[t.ui.prop]?void 0:t.title,name:t.ui.prop,rules:t.ui.rules,class:t.ui.class,style:{width:t.ui.gutter.controlWidth},wrapperCol:{span:t.ui.gutter.spanControl,offset:t.ui.gutter.controlffset},labelCol:{span:t.ui.gutter.spanLabel,offset:t.ui.gutter.spanOffset}},Object(o.createSlots)({default:r(()=>[(Object(o.openBlock)(),Object(o.createBlock)(Object(o.resolveDynamicComponent)(t.ui.widget),{ui:t.ui,schema:t,modelValue:e.form[t.ui.prop],"onUpdate:modelValue":n=>e.form[t.ui.prop]=n,ref:e.addItem(t.ui.prop)},null,8,["ui","schema","modelValue","onUpdate:modelValue"]))]),_:2},[e.$slots[t.ui.prop]?{name:"label",fn:r(()=>[Object(o.renderSlot)(e.$slots,t.ui.prop,{schema:t},void 0,!0)])}:void 0]),1032,["label","name","rules","class","style","wrapperCol","labelCol"])):Object(o.createCommentVNode)("v-if",!0)]),_:2},1032,["span"]))),128))]),_:1})]),_:1},8,["model","layout"]),e.button$?(Object(o.openBlock)(),Object(o.createBlock)("div",{key:0,class:e.button$.className},[Object(o.createVNode)(b,{type:"flex",justify:e.button$.span?"start":"end"},{default:r(()=>[Object(o.createVNode)(d,{class:"text-right",span:e.button$.span},{default:r(()=>[e.button$.hideReset?Object(o.createCommentVNode)("v-if",!0):(Object(o.openBlock)(),Object(o.createBlock)(f,{key:0,onClick:e.reset,class:"mr-md"},{default:r(()=>[Object(o.createTextVNode)(Object(o.toDisplayString)(e.button$.resetText||"取消"),1)]),_:1},8,["onClick"])),e.button$.hideSubmit?Object(o.createCommentVNode)("v-if",!0):Object(o.withDirectives)((Object(o.openBlock)(),Object(o.createBlock)(f,{key:1,type:"primary",onClick:e.submit},{default:r(()=>[Object(o.createTextVNode)(Object(o.toDisplayString)(e.button$.submitText||"确定"),1)]),_:1},8,["onClick"])),[[m]])]),_:1},8,["span"])]),_:1},8,["justify"])],2)):Object(o.createCommentVNode)("v-if",!0)])}),l=Symbol("form"),u=Symbol("formRef"),i={offset:0,controlWidth:"auto",spanLabel:5,spanControl:17,span:24};var c=n(7),s=n.n(c),d=n(10),b=n.n(d),p=n(11),f=n.n(p),m=n(12),v=n.n(m);var O=n(1),j=n(8),y=n.n(j),g=Object(o.defineComponent)({name:"sf-input",props:{modelValue:[String,Number,Boolean],ui:Object,schema:Object},components:{[y.a.name]:y.a,[y.a.Password.name]:y.a.Password},setup:(e,t)=>({model$:Object(O.useModel)(e,t)})});g.render=function(e,t,n,r,a,l){const u=Object(o.resolveComponent)("a-input-password"),i=Object(o.resolveComponent)("a-input");return e.ui.showPassword?(Object(o.openBlock)(),Object(o.createBlock)(u,{key:0,value:e.model$,"onUpdate:value":t[1]||(t[1]=t=>e.model$=t),placeholder:e.ui.placeholder,disabled:e.schema.readOnly},null,8,["value","placeholder","disabled"])):(Object(o.openBlock)(),Object(o.createBlock)(i,{key:1,placeholder:e.ui.placeholder,value:e.model$,"onUpdate:value":t[2]||(t[2]=t=>e.model$=t),disabled:e.schema.readOnly},null,8,["placeholder","value","disabled"]))};var h=g,k=n(2);class w{getValue(e){return null==e?null:this.fallbackValue(e)}}class x extends w{fallbackValue(e){return""+e}}const C={string:x,regexp:x,any:class extends w{fallbackValue(e){return e}},number:class extends w{fallbackValue(e){return"string"==typeof e?e.length>0?+e:null:+e}},boolean:class extends w{fallbackValue(e){return!!e}}};var B=Object(o.defineComponent)({name:"sf",props:{schema:Object,width:String,button:Object,formData:Object},emits:{formSubmit:null,formReset:null},components:{[s.a.name]:s.a,[s.a.Item.name]:s.a.Item,[b.a.name]:b.a,[f.a.name]:f.a,[v.a.name]:v.a},directives:{btnLoading:new k.BtnLoading},setup(e,t){const n=Object(o.ref)(null),r=Object(o.reactive)([]),a=Object(o.reactive)({...e.formData||{}});Object(o.provide)(l,a),Object(o.provide)(u,n);let c={};Object(o.watch)(()=>e.schema,e=>{var t;c={};const n={...i,...(null==e||null===(t=e.ui)||void 0===t?void 0:t.gutter)||{}},l=e.properties;Object.keys(l).forEach(e=>{const t={...l[e]};t.ui={...t.ui||{}},t.ui.widget=Object(o.markRaw)(t.ui.widget||h),t.ui.placeholder=t.ui.placeholder||"请填写"+t.title,t.ui.prop=e,t.ui.rules=null==t.ui.rules?[]:Array.isArray(t.ui.rules)?t.ui.rules:[t.ui.rules];const u=t.type=t.type||"string";if(t.required){t.ui.rules.find(e=>!0===e.required)||t.ui.rules.push(((e,t)=>({required:!0,fullField:e.title,trigger:k.CUSTOM_TRIGGER,type:t,transform:e=>(new C[t]).getValue(e)}))(t,u))}t.ui.validate&&t.ui.rules.push({...t.ui.validate,validator:t.ui.validate.validator(a)}),t.ui.hidden||r.push(t),t.ui.gutter={...n,...t.ui.gutter||{}}}),r.forEach(e=>{if(e.ui.visibleIf){const t=Object.keys(e.ui.visibleIf).map(e=>(a.hasOwnProperty(e)||(a[e]=null),Object(o.toRef)(a,e)));Object(o.watch)(t,t=>{let n=!0;t.forEach((t,o)=>{const r=Object.values(e.ui.visibleIf),a=Array.isArray(r[o])?()=>r[o].includes(t):r[o];n=n&&a(t)}),e.show=n},{immediate:!0})}else e.show=!0})},{immediate:!0}),Object(o.watch)(()=>e.formData,e=>{e=e||{};const t=new Set(Object.keys(a));Object.keys(e).forEach(e=>{t.add(e)}),Array.from(t).forEach(t=>{a[t]=void 0!==e[t]?e[t]:a[t]})});const s=Object(o.computed)(()=>null===e.button?null:e.button||{});return{items:r,formRef:n,form:a,submit:()=>{n.value.validate().then(()=>{t.emit("formSubmit",a)})},reset:()=>{t.emit("formReset",a)},button$:s,searchProperty:e=>c[e],addItem:e=>t=>{c[e]=t}}}});n(22);B.render=a,B.__scopeId="data-v-a5e051da";var V=B;function S(e){return null==e}function q(e,t,n){return S(e)||!Array.isArray(e)||0===e.length?[]:("object"!=typeof e[0]&&(e=e.map(e=>({label:e,value:e}))),t&&(Array.isArray(t)||(t=[t]),e.forEach(e=>{~t.indexOf(e.value)&&(e.checked=!0)})),n&&e.forEach(e=>e.disabled=!0),e)}function $(e,t,n){return q(Object(O.deepCopy)(e||[]),t,n)}function _(e,t,n){return t.asyncData?t.asyncData().then(t=>q(t,n,e.readOnly)):Promise.resolve($(e.enums,n,e.readOnly))}function N(e){return Object.keys(e).map(t=>({label:e[t],value:t}))}V.install=e=>{e.component(V.name,V)};const D=V;t.default=D}])}));
//# sourceMappingURL=index.js.map